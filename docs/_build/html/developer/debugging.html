

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Debugging &mdash; Turbinia  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Developing new Turbinia Tasks and Evidence types" href="developing-new-tasks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Turbinia
          

          
            
            <img src="../_static/turbinia-logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing-new-tasks.html">Developing new Turbinia Tasks and Evidence types</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logs">Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-debugging">Task Debugging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#task-failures">Task Failures</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disappearing-tasks">Disappearing Tasks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#common-errors">Common Errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Turbinia</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Developer documentation</a> &raquo;</li>
        
      <li>Debugging</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/developer/debugging.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="debugging">
<h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h1>
<div class="section" id="logs">
<h2>Logs<a class="headerlink" href="#logs" title="Permalink to this headline">¶</a></h2>
<p>There are a few different logs that may be useful when debugging:</p>
<ul class="simple">
<li><p>Server log: By default this is on the server in
<code class="docutils literal notranslate"><span class="pre">OUTPUT_DIR/turbinia-server.log</span></code></p></li>
<li><p>Worker logs: By default this is on the workers in
<code class="docutils literal notranslate"><span class="pre">OUTPUT_DIR/turbinia-worker.log</span></code></p></li>
<li><p>Task logs: These are logs that are generated by a Task running in the
Worker. If you have GCS enabled, then these logs are saved there, and
in either case, the paths can be determined with
<code class="docutils literal notranslate"><span class="pre">turbiniactl</span> <span class="pre">-a</span> <span class="pre">status</span></code> (note that -a is required to show all data
associated with the tasks).</p></li>
<li><p>Task execution logs. These are the logs that are generated by binaries
executed from a Task. For example, Plaso generates its own log file, and
that gets saved by the Task. As with the Task logs, these can be stored in
GCS and retrieved with <code class="docutils literal notranslate"><span class="pre">gsutil</span></code>.</p></li>
</ul>
</div>
<div class="section" id="task-debugging">
<h2>Task Debugging<a class="headerlink" href="#task-debugging" title="Permalink to this headline">¶</a></h2>
<div class="section" id="task-failures">
<h3>Task Failures<a class="headerlink" href="#task-failures" title="Permalink to this headline">¶</a></h3>
<p>The following is an example of debugging a task failure:</p>
<p>Running turbiniactl, we see a failure of the PsortTask:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./turbiniactl status -d1

Retrieved 2 Task results:
2017-12-06T15:09:15.013Z PsortTask Failed: Execution failed with status 1
2017-12-06T15:08:49.616Z PlasoTask Successful: Completed successfully in 0:00:14.178579 on aaronp.dev
</pre></div>
</div>
<p>We can specify <code class="docutils literal notranslate"><span class="pre">-a</span></code> to get all info we have about that Task, and this
will include the request Id, Task Id, and the other logs associated with
the task.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./turbiniactl -a status -d1

Retrieved 2 Task results:
2017-12-06T15:09:15.013Z request: None task: 1f8c4b321f444614bde296b0a00bb91f PsortTask Failed: Execution failed with status 1
        gs://my-turbinia-bucket/output/1512601742-1f8c4b321f444614bde296b0a00bb91f-PsortTask/worker-log.txt
2017-12-06T15:08:49.616Z request: b94ad420cf5a483fb3fc4409d5fc6dcd task: 020fe728a2b64dc7ba1da2656e1cc454 PlasoTask Successful: Completed successfully in 0:00:14.178579 on aaronp.dev
        gs://my-turbinia-bucket/output/1512601704-020fe728a2b64dc7ba1da2656e1cc454-PlasoTask/020fe728a2b64dc7ba1da2656e1cc454.log
        gs://my-turbinia-bucket/output/1512601704-020fe728a2b64dc7ba1da2656e1cc454-PlasoTask/worker-log.txt
</pre></div>
</div>
<p>Note that there may be local paths that show up in the
<code class="docutils literal notranslate"><span class="pre">turbiniactl</span> <span class="pre">status</span></code> output, and these are local to the Worker that
executed that Task.</p>
<p>Using the saved paths above we can display the output with <code class="docutils literal notranslate"><span class="pre">gsutil</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gsutil cat gs://my-turbinia-bucket/output/1512601742-1f8c4b321f444614bde296b0a00bb91f-PsortTask/worker-log.txt

Running psort as [psort.py --status_view none --logfile /var/tmp/1512601742-1f8c4b321f444614bde296b0a00bb91f-PsortTask/1f8c4b321f444614bde296b0a00bb91f.log -w /var/tmp/1512601742-1f8c4b321f444614bde296b0a00bb91f-PsortTask/1f8c4b321f444614bde296b0a00bb91f.csv /var/tmp/1512601730-b04f479ef9094954968474431aa30e8a-PsortTask/b04f479ef9094954968474431aa30e8a.csv]
Execution failed with status 1
</pre></div>
</div>
</div>
<div class="section" id="disappearing-tasks">
<h3>Disappearing Tasks<a class="headerlink" href="#disappearing-tasks" title="Permalink to this headline">¶</a></h3>
<p>If the Turbinia server is scheduling Tasks, but you’re not seeing the
Tasks or their output for some reason, the most common scenario is that
either a second Turbinia server or a second set of Workers is running
and operating on the same PubSub queues.  Make sure that you have unique
values per each Turbinia instance for the following config variables:
<code class="docutils literal notranslate"><span class="pre">PSQ_TOPIC</span></code>, <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">PUBSUB_TOPIC</span></code> and <code class="docutils literal notranslate"><span class="pre">KOMBU_CHANNEL</span></code> (if you
are using a local Turbinia installation type.</p>
</div>
</div>
<div class="section" id="common-errors">
<h2>Common Errors<a class="headerlink" href="#common-errors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>If you encounter a cycle of errors on the Turbinia server when decoding
specific malformed pubsub messages, and the failure happens prior to the
server acknowledging the pubsub message, you may need to manually clear the
pubsub queue. If you are sure there aren’t other outstanding requests, you
can just pull and auto-ack the existing messages, otherwise you may need a
variation of this command to selectively ack messages:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gcloud beta pubsub subscriptions pull --auto-ack $my-pubsub-subscription-name
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="developing-new-tasks.html" class="btn btn-neutral float-left" title="Developing new Turbinia Tasks and Evidence types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Turbinia contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>